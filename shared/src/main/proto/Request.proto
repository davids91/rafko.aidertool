
syntax = "proto3";
option java_package = "org.rafko.aidertool";
option java_outer_classname = "RequestDealer";

package AiderTool;

enum RequestState{
  STATE_UNKNOWN = 0;
  STATE_INVALID = 1;
  STATE_REQUEST_REJECTED = 2;
  STATE_REQUEST_OK = 3;
  STATE_OPEN = 10;
  STATE_WAITING = 11;
  STATE_ACTIVE = 12;
  STATE_PENDING = 13;
  STATE_FINISHED = 20;
  STATE_CANCELLED = 21;
}

message AidRequest{
  string requesterUUID = 1;
  RequestState state = 10;
  repeated string tags = 11;
}

message AidToken{
  uint32 requestID = 1;
  string UserUUID = 2;
  RequestState state = 10;
  repeated string tags = 11;
  repeated string data = 12;
}

service RequestHandler{
  rpc ping(AidRequest) returns (AidToken);
  rpc addRequest(AidRequest) returns (AidToken);
  rpc cancelRequest(AidRequest) returns (AidToken);

  rpc queryRequest(AidToken) returns (AidToken);
  rpc queryRequests(AidToken) returns (stream AidToken);
  rpc queryTags(AidToken) returns (AidToken); /* empty requestID means all tags */

  rpc initiate(AidToken) returns (AidToken);
  rpc finalize(AidToken) returns (AidToken);
}